DIGITS = range(61, 81)
SEEDS = ('042', '069', '151', '401', '404')
NOISE = ("0.010", "0.020", "0.030", "0.040")
from glob import glob
import os
from pathlib import Path
import re

include: "rules/ACDC.smk"
include: "rules/simulation.smk"
include: "rules/subject.smk"

def remove_suffix(filename:Path):
    while filename.suffix:
        filename = filename.with_suffix('')
    return filename


subject_data = glob("data/subject_data/*/*[!mask].nii.gz")

FOLDER = [os.path.basename(Path(x).parent) for x in subject_data]

wildcard_constraints:
    seed= '|'.join([re.escape(x) for x in SEEDS]),
    folder= '|'.join([re.escape(x) for x in FOLDER]),
    noise= '|'.join([re.escape(x) for x in NOISE])

rule all:
    input:
        "analysis/plots/mrxcat_simulation/features_curves/top12_features.png",
        "analysis/plots/mrxcat_simulation/total_mae_vs_snr_mae.png",
        "analysis/plots/mrxcat_simulation/total_mae_vs_snr_mae_1.png",
        "analysis/plots/mrxcat_simulation/rank_barcode.png",
        expand("analysis/plots/subject/features_curves/{folder}/top12_features.png", folder = FOLDER),
        "analysis/plots/subject/total_mae_vs_snr_mae.png",
        "analysis/plots/subject/total_mae_vs_snr_mae_1.png",
        "analysis/plots/subject/rank_barcode.png",
        expand("analysis/plots/ACDC/features_curves/patient0{digits}/top12_features.png", digits = DIGITS),
        "analysis/plots/ACDC/total_mae_vs_snr_mae.png",
        "analysis/plots/ACDC/total_mae_vs_snr_mae_1.png",
        "analysis/plots/ACDC/rank_barcode.png",
        expand("analysis/tables/subject/mae_{folder}.csv", folder = FOLDER),
        expand("analysis/tables/ACDC/ranks_patient0{digits}.csv", digits = DIGITS)



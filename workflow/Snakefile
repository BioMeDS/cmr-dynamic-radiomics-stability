#SNR, REPLICATE, _  = glob_wildcards("data/mrxcat_simulations/{snr}_{replicate}/{cpx}.cpx")
#SNR = glob_wildcards("bla/{snr}")
#SNR2 = [x.replace('_', '/') for x in SNR[0]]
SNR = (5, 10, 20, 30)
REPLICATE = range(1,6)
NUMBER = range(1,25)

rule all:
    input:
        expand("data/mrxcat_simulations/snr{snr}_{replicate}/csvs/cine_1x1x1mm_512x512x1x24x4_snr{snr}_fa90_bh{number}.csv", 
        snr=SNR, replicate=REPLICATE, number=NUMBER),

rule SimSaveAsCsv:
    input:
        "data/mrxcat_simulations"
    output:
        expand("data/mrxcat_simulations/snr{snr}_{replicate}/csvs/cine_1x1x1mm_512x512x1x24x4_snr{snr}_fa90_bh{number}.csv", 
        snr=SNR, replicate=REPLICATE, number=NUMBER)
    conda:
        "octave_env.yaml"
    shell:
        "cd code/mrxcat_simulations;"
        "octave SaveAsCsv.m --no-gui"

rule SimConvertCsvToNifti:
    input:
        expand("data/mrxcat_simulations/snr{snr}_{replicate}/csvs/cine_1x1x1mm_512x512x1x24x4_snr{snr}_fa90_bh{number}.csv", 
        snr=SNR, replicate=REPLICATE, number=NUMBER)
    output:
        expand("data/mrxcat_simulations/snr{snr}_{replicate}/nifti/cine_1x1x1mm_512x512x1x24x4_snr{snr}_fa90_bh{number}.nii.gz", 
        snr=SNR, replicate=REPLICATE, number=NUMBER)
    conda:
        "conversion_sim.yaml"
    script:
        "../code/mrxcat_simulations/convert_csv_to_nifti.py"
